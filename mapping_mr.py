# Funci√≥n de mapeo para las AP de las VDDL
import numpy as np
import re
from openpyxl import load_workbook
from openpyxl.styles import NamedStyle, PatternFill, Border, Side, Font
from datetime import datetime

def process_vddl(df):
    mapping = {
        'P-22/001-S00': '', 'P-22/002-S00': '', 'P-22/003-S00': '', 'P-22/004-S00': '', 'P-22/005-S00': '',
        'P-22/006-S00': '', 'P-22/007-S00': '', 'P-22/008-S00': '', 'P-22/009-S00': '', 'P-22/010-S00': '',
        'P-22/011-S00': '', 'P-22/012-S00': '', 'P-22/013-S00': '', 'P-22/014-S00': '', 'P-22/015-S00': '',
        'P-22/016-S00': '', 'P-22/017-S00': '', 'P-22/018-S00': '', 'P-22/019-S00': '', 'P-22/020-S00': '',
        'P-22/021-S00': '', 'P-22/022-S00': '', 'P-22/023-S00': '', 'P-22/024-S00': '', 'P-22/025-S00': '',
        'P-22/026-S00': '', 'P-22/027-S00': '', 'P-22/028-S00': '', 'P-22/029-S00': '', 'P-22/030-S00': '',
        'P-22/031-S00': '', 'P-22/032-S00': '', 'P-22/033-S00': '', 'P-22/034-S00': '', 'P-22/035-S00': '',
        'P-22/036-S00': '', 'P-22/037-S00': '', 'P-22/038-S00': '', 'P-22/039-S00': '', 'P-22/040-S00': '',
        'P-22/041-S00': '', 'P-22/042-S00': '', 'P-22/043-S00': '', 'P-22/044-S00': '', 'P-22/045-S00': '',
        'P-22/046-S00': '', 'P-22/047-S00': '', 'P-22/048-S00': '', 'P-22/049-S00': '', 'P-22/050-S00': '',
        'P-22/051-S00': '', 'P-22/052-S00': '', 'P-22/053-S00': '', 'P-22/054-S00': '', 'P-22/055-S00': '',
        'P-22/056-S00': '', 'P-22/057-S00': '', 'P-22/058-S00': '', 'P-22/059-S00': '', 'P-22/060-S00': '',
        'P-22/061-S00': '', 'P-22/062-S00': '', 'P-22/063-S00': '', 'P-22/064-S00': '', 'P-22/065-S00': '',
        'P-22/066-S00': '', 'P-22/067-S00': '', 'P-22/068-S00': '', 'P-22/069-S00': '', 'P-22/070-S00': '',
        'P-22/071-S00': '', 'P-22/072-S00': '', 'P-22/073-S00': '', 'P-22/074-S00': '22-11-2023', 'P-22/075-S00': '',
        'P-22/076-S00': '', 'P-22/077-S00': '', 'P-22/078-S00': '', 'P-22/079-S00': '', 'P-22/080-S00': '',
        'P-22/081-S00': '', 'P-22/082-S00': '', 'P-22/083-S00': '', 'P-22/084-S00': '', 'P-22/085-S00': '',
        'P-22/086-S00': '', 'P-22/087-S00': '', 'P-22/088-S00': '', 'P-22/089-S00': '', 'P-22/090-S00': '',
        'P-22/091-S00': '', 'P-22/092-S00': '', 'P-22/093-S00': '', 'P-22/094-S00': '', 'P-22/095-S00': '',
        'P-22/096-S00': '', 'P-22/097-S00': '', 'P-22/098-S00': '', 'P-22/099-S00': '', 'P-22/100-S00': '',
        'P-22/101-S00': '', 'P-22/102-S00': '', 'P-22/103-S00': '', 'P-22/104-S00': '', 'P-22/105-S00': '',
        'P-23/001-S00': '23-01-2023', 'P-23/002-S00': '03-01-2023', 'P-23/003-S00': '05-01-2023', 'P-23/004-S00': '', 'P-23/005-S00': '',
        'P-23/006-S00': '', 'P-23/007-S00': '', 'P-23/008-S00': '', 'P-23/009-S00': '', 'P-23/010-S00': '',
        'P-23/011-S00': '', 'P-23/012-S00': '', 'P-23/013-S00': '', 'P-23/014-S00': '', 'P-23/015-S00': '',
        'P-23/016-S00': '', 'P-23/017-S00': '', 'P-23/018-S00': '', 'P-23/019-S00': '', 'P-23/020-S00': '',
        'P-23/021-S00': '', 'P-23/022-S00': '', 'P-23/023-S00': '', 'P-23/024-S00': '', 'P-23/025-S00': '',
        'P-23/026-S00': '', 'P-23/027-S00': '14-03-2023', 'P-23/028-S00': '', 'P-23/029-S00': '', 'P-23/030-S00': '',
        'P-23/031-S00': '', 'P-23/032-S00': '', 'P-23/033-S00': '', 'P-23/034-S00': '16-06-2023', 'P-23/035-S00': '',
        'P-23/036-S00': '', 'P-23/037-S00': '', 'P-23/038-S00': '', 'P-23/039-S00': '', 'P-23/040-S00': '',
        'P-23/041-S00': '', 'P-23/042-S00': '', 'P-23/043-S00': '', 'P-23/044-S00': '04/05/2023', 'P-23/045-S00': '',
        'P-23/046-S00': '', 'P-23/047-S00': '', 'P-23/048-S00': '22/05/2023', 'P-23/049-S00': '', 'P-23/050-S00': '',
        'P-23/051-S00': '', 'P-23/052-S00': '', 'P-23/053-S00': '', 'P-23/054-S00': '', 'P-23/055-S00': '',
        'P-23/056-S00': '', 'P-23/057-S00': '', 'P-23/058-S00': '', 'P-23/059-S00': '', 'P-23/060-S00': '',
        'P-23/061-S00': '', 'P-23/062-S00': '', 'P-23/063-S00': '', 'P-23/064-S00': '', 'P-23/065-S00': '',
        'P-23/066-S00': '', 'P-23/067-S00': '', 'P-23/068-S00': '', 'P-23/069-S00': '', 'P-23/070-S00': '',
        'P-23/071-S00': '', 'P-23/072-S00': '', 'P-23/073-S00': '', 'P-23/074-S00': '07-08-2023', 'P-23/075-S00': '',
        'P-23/076-S00': '', 'P-23/077-S00': '', 'P-23/078-S00': '', 'P-23/079-S00': '', 'P-23/080-S00': '',
        'P-23/081-S00': '', 'P-23/082-S00': '', 'P-23/083-S00': '', 'P-23/084-S00': '', 'P-23/085-S00': '',
        'P-23/086-S00': '', 'P-23/087-S00': '', 'P-23/088-S00': '', 'P-23/089-S00': '', 'P-23/090-S00': '',
        'P-23/091-S00': '', 'P-23/092-S00': '', 'P-23/093-S00': '', 'P-23/094-S00': '', 'P-23/095-S00': '',
        'P-23/096-S00': '', 'P-23/097-S00': '', 'P-23/098-S00': '', 'P-23/099-S00': '', 'P-23/100-S00': '',
        'P-23/101-S00': '', 'P-23/102-S00': '', 'P-23/103-S00': '', 'P-23/104-S00': '', 'P-23/105-S00': '04-05-2023',
        'P-24/001-S00': '', 'P-24/002-S00': '', 'P-24/003-S00': '', 'P-24/004-S00': '', 'P-24/005-S00': '',
        'P-24/006-S00': '', 'P-24/007-S00': '', 'P-24/008-S00': '', 'P-24/009-S00': '', 'P-24/010-S00': '',
        'P-24/011-S00': '', 'P-24/012-S00': '', 'P-24/013-S00': '', 'P-24/014-S00': '', 'P-24/015-S00': '',
        'P-24/016-S00': '', 'P-24/017-S00': '', 'P-24/018-S00': '', 'P-24/019-S00': '', 'P-24/020-S00': '',
        'P-24/021-S00': '', 'P-24/022-S00': '', 'P-24/023-S00': '', 'P-24/024-S00': '', 'P-24/025-S00': '',
        'P-24/026-S00': '', 'P-24/027-S00': '', 'P-24/028-S00': '', 'P-22/001-S01': '', 'P-22/002-S01': '',
        'P-22/003-S01': '', 'P-22/004-S01': '', 'P-22/005-S01': '', 'P-22/006-S01': '', 'P-22/007-S01': '',
        'P-22/008-S01': '', 'P-22/009-S01': '', 'P-22/010-S01': '', 'P-22/011-S01': '', 'P-22/012-S01': '',
        'P-22/013-S01': '', 'P-22/014-S01': '', 'P-22/015-S01': '', 'P-22/016-S01': '', 'P-22/017-S01': '',
        'P-22/018-S01': '', 'P-22/019-S01': '', 'P-22/020-S01': '', 'P-22/021-S01': '', 'P-22/022-S01': '',
        'P-22/023-S01': '', 'P-22/024-S01': '', 'P-22/025-S01': '', 'P-22/026-S01': '', 'P-22/027-S01': '',
        'P-22/028-S01': '', 'P-22/029-S01': '', 'P-22/030-S01': '', 'P-22/031-S01': '', 'P-22/032-S01': '',
        'P-22/033-S01': '', 'P-22/034-S01': '', 'P-22/035-S01': '', 'P-22/036-S01': '', 'P-22/037-S01': '',
        'P-22/038-S01': '', 'P-22/039-S01': '', 'P-22/040-S01': '', 'P-22/041-S01': '', 'P-22/042-S01': '',
        'P-22/043-S01': '', 'P-22/044-S01': '', 'P-22/045-S01': '', 'P-22/046-S01': '', 'P-22/047-S01': '',
        'P-22/048-S01': '', 'P-22/049-S01': '', 'P-22/050-S01': '', 'P-22/051-S01': '', 'P-22/052-S01': '',
        'P-22/053-S01': '', 'P-22/054-S01': '', 'P-22/055-S01': '', 'P-22/056-S01': '', 'P-22/057-S01': '',
        'P-22/058-S01': '', 'P-22/059-S01': '', 'P-22/060-S01': '', 'P-22/061-S01': '', 'P-22/062-S01': '',
        'P-22/063-S01': '', 'P-22/064-S01': '', 'P-22/065-S01': '', 'P-22/066-S01': '', 'P-22/067-S01': '',
        'P-22/068-S01': '', 'P-22/069-S01': '', 'P-22/070-S01': '', 'P-22/071-S01': '', 'P-22/072-S01': '',
        'P-22/073-S01': '', 'P-22/074-S01': '', 'P-22/075-S01': '', 'P-22/076-S01': '', 'P-22/077-S01': '',
        'P-22/078-S01': '', 'P-22/079-S01': '', 'P-22/080-S01': '', 'P-22/081-S01': '', 'P-22/082-S01': '',
        'P-22/083-S01': '', 'P-22/084-S01': '', 'P-22/085-S01': '', 'P-22/086-S01': '', 'P-22/087-S01': '',
        'P-22/088-S01': '', 'P-22/089-S01': '', 'P-22/090-S01': '', 'P-22/091-S01': '', 'P-22/092-S01': '',
        'P-22/093-S01': '', 'P-22/094-S01': '', 'P-22/095-S01': '', 'P-22/096-S01': '', 'P-22/097-S01': '',
        'P-22/098-S01': '', 'P-22/099-S01': '', 'P-22/100-S01': '', 'P-22/101-S01': '', 'P-22/102-S01': '',
        'P-22/103-S01': '', 'P-22/104-S01': '', 'P-22/105-S01': '', 'P-23/001-S01': '', 'P-23/002-S01': '',
        'P-23/003-S01': '', 'P-23/004-S01': '', 'P-23/005-S01': '', 'P-23/006-S01': '', 'P-23/007-S01': '',
        'P-23/008-S01': '', 'P-23/009-S01': '', 'P-23/010-S01': '', 'P-23/011-S01': '', 'P-23/012-S01': '',
        'P-23/013-S01': '', 'P-23/014-S01': '', 'P-23/015-S01': '', 'P-23/016-S01': '', 'P-23/017-S01': '',
        'P-23/018-S01': '', 'P-23/019-S01': '', 'P-23/020-S01': '', 'P-23/021-S01': '', 'P-23/022-S01': '',
        'P-23/023-S01': '', 'P-23/024-S01': '', 'P-23/025-S01': '', 'P-23/026-S01': '', 'P-23/027-S01': '',
        'P-23/028-S01': '', 'P-23/029-S01': '', 'P-23/030-S01': '', 'P-23/031-S01': '', 'P-23/032-S01': '',
        'P-23/033-S01': '', 'P-23/034-S01': '', 'P-23/035-S01': '', 'P-23/036-S01': '', 'P-23/037-S01': '09-02-2024',
        'P-23/038-S01': '', 'P-23/039-S01': '', 'P-23/040-S01': '', 'P-23/041-S01': '', 'P-23/042-S01': '',
        'P-23/043-S01': '', 'P-23/044-S01': '', 'P-23/045-S01': '', 'P-23/046-S01': '', 'P-23/047-S01': '',
        'P-23/048-S01': '', 'P-23/049-S01': '', 'P-23/050-S01': '', 'P-23/051-S01': '', 'P-23/052-S01': '',
        'P-23/053-S01': '', 'P-23/054-S01': '', 'P-23/055-S01': '', 'P-23/056-S01': '', 'P-23/057-S01': '',
        'P-23/058-S01': '', 'P-23/059-S01': '', 'P-23/060-S01': '', 'P-23/061-S01': '', 'P-23/062-S01': '',
        'P-23/063-S01': '', 'P-23/064-S01': '', 'P-23/065-S01': '', 'P-23/066-S01': '', 'P-23/067-S01': '',
        'P-23/068-S01': '', 'P-23/069-S01': '', 'P-23/070-S01': '', 'P-23/071-S01': '', 'P-23/072-S01': '',
        'P-23/073-S01': '', 'P-23/074-S01': '', 'P-23/075-S01': '', 'P-23/076-S01': '', 'P-23/077-S01': '',
        'P-23/078-S01': '', 'P-23/079-S01': '', 'P-23/080-S01': '', 'P-23/081-S01': '', 'P-23/082-S01': '',
        'P-23/083-S01': '', 'P-23/084-S01': '', 'P-23/085-S01': '', 'P-23/086-S01': '', 'P-23/087-S01': '',
        'P-23/088-S01': '', 'P-23/089-S01': '', 'P-23/090-S01': '', 'P-23/091-S01': '', 'P-23/092-S01': '',
        'P-23/093-S01': '', 'P-23/094-S01': '', 'P-23/095-S01': '', 'P-23/096-S01': '', 'P-23/097-S01': '',
        'P-23/098-S01': '', 'P-23/099-S01': '', 'P-23/100-S01': '', 'P-23/101-S01': '', 'P-23/102-S01': '',
        'P-23/103-S01': '', 'P-23/104-S01': '', 'P-23/105-S01': '', 'P-24/001-S01': '', 'P-24/002-S01': '',
        'P-24/003-S01': '', 'P-24/004-S01': '', 'P-24/005-S01': '', 'P-24/006-S01': '', 'P-24/007-S01': '',
        'P-24/008-S01': '', 'P-24/009-S01': '', 'P-24/010-S01': '', 'P-24/011-S01': '', 'P-24/012-S01': '',
        'P-24/013-S01': '', 'P-24/014-S01': '', 'P-24/015-S01': '', 'P-24/016-S01': '', 'P-24/017-S01': '',
        'P-24/018-S01': '', 'P-24/019-S01': '', 'P-24/020-S01': '', 'P-24/021-S01': '', 'P-24/022-S01': '',
        'P-24/023-S01': '', 'P-24/024-S01': '', 'P-24/025-S01': '', 'P-24/026-S01': '', 'P-24/027-S01': '',
        'P-24/028-S01': '', 'P-22/001-S02': '', 'P-22/002-S02': '', 'P-22/003-S02': '', 'P-22/004-S02': '',
        'P-22/005-S02': '', 'P-22/006-S02': '', 'P-22/007-S02': '', 'P-22/008-S02': '', 'P-22/009-S02': '',
        'P-22/010-S02': '', 'P-22/011-S02': '', 'P-22/012-S02': '', 'P-22/013-S02': '', 'P-22/014-S02': '',
        'P-22/015-S02': '', 'P-22/016-S02': '', 'P-22/017-S02': '', 'P-22/018-S02': '', 'P-22/019-S02': '',
        'P-22/020-S02': '', 'P-22/021-S02': '', 'P-22/022-S02': '', 'P-22/023-S02': '', 'P-22/024-S02': '',
        'P-22/025-S02': '', 'P-22/026-S02': '', 'P-22/027-S02': '', 'P-22/028-S02': '', 'P-22/029-S02': '',
        'P-22/030-S02': '', 'P-22/031-S02': '', 'P-22/032-S02': '', 'P-22/033-S02': '', 'P-22/034-S02': '',
        'P-22/035-S02': '', 'P-22/036-S02': '', 'P-22/037-S02': '', 'P-22/038-S02': '', 'P-22/039-S02': '',
        'P-22/040-S02': '', 'P-22/041-S02': '', 'P-22/042-S02': '', 'P-22/043-S02': '', 'P-22/044-S02': '',
        'P-22/045-S02': '', 'P-22/046-S02': '', 'P-22/047-S02': '', 'P-22/048-S02': '', 'P-22/049-S02': '',
        'P-22/050-S02': '', 'P-22/051-S02': '', 'P-22/052-S02': '', 'P-22/053-S02': '', 'P-22/054-S02': '',
        'P-22/055-S02': '', 'P-22/056-S02': '', 'P-22/057-S02': '', 'P-22/058-S02': '', 'P-22/059-S02': '',
        'P-22/060-S02': '', 'P-22/061-S02': '', 'P-22/062-S02': '', 'P-22/063-S02': '', 'P-22/064-S02': '',
        'P-22/065-S02': '', 'P-22/066-S02': '', 'P-22/067-S02': '', 'P-22/068-S02': '', 'P-22/069-S02': '',
        'P-22/070-S02': '', 'P-22/071-S02': '', 'P-22/072-S02': '', 'P-22/073-S02': '', 'P-22/074-S02': '',
        'P-22/075-S02': '', 'P-22/076-S02': '', 'P-22/077-S02': '', 'P-22/078-S02': '', 'P-22/079-S02': '',
        'P-22/080-S02': '', 'P-22/081-S02': '', 'P-22/082-S02': '', 'P-22/083-S02': '', 'P-22/084-S02': '',
        'P-22/085-S02': '', 'P-22/086-S02': '', 'P-22/087-S02': '', 'P-22/088-S02': '', 'P-22/089-S02': '',
        'P-22/090-S02': '', 'P-22/091-S02': '', 'P-22/092-S02': '', 'P-22/093-S02': '', 'P-22/094-S02': '',
        'P-22/095-S02': '', 'P-22/096-S02': '', 'P-22/097-S02': '', 'P-22/098-S02': '', 'P-22/099-S02': '',
        'P-22/100-S02': '', 'P-22/101-S02': '', 'P-22/102-S02': '', 'P-22/103-S02': '', 'P-22/104-S02': '',
        'P-22/105-S02': '', 'P-23/001-S02': '', 'P-23/002-S02': '', 'P-23/003-S02': '', 'P-23/004-S02': '',
        'P-23/005-S02': '', 'P-23/006-S02': '', 'P-23/007-S02': '', 'P-23/008-S02': '', 'P-23/009-S02': '',
        'P-23/010-S02': '', 'P-23/011-S02': '', 'P-23/012-S02': '', 'P-23/013-S02': '', 'P-23/014-S02': '',
        'P-23/015-S02': '', 'P-23/016-S02': '', 'P-23/017-S02': '', 'P-23/018-S02': '', 'P-23/019-S02': '',
        'P-23/020-S02': '', 'P-23/021-S02': '', 'P-23/022-S02': '', 'P-23/023-S02': '', 'P-23/024-S02': '',
        'P-23/025-S02': '', 'P-23/026-S02': '', 'P-23/027-S02': '', 'P-23/028-S02': '', 'P-23/029-S02': '',
        'P-23/030-S02': '', 'P-23/031-S02': '', 'P-23/032-S02': '', 'P-23/033-S02': '', 'P-23/034-S02': '',
        'P-23/035-S02': '', 'P-23/036-S02': '', 'P-23/037-S02': '', 'P-23/038-S02': '', 'P-23/039-S02': '',
        'P-23/040-S02': '', 'P-23/041-S02': '', 'P-23/042-S02': '', 'P-23/043-S02': '', 'P-23/044-S02': '',
        'P-23/045-S02': '', 'P-23/046-S02': '', 'P-23/047-S02': '', 'P-23/048-S02': '', 'P-23/049-S02': '',
        'P-23/050-S02': '', 'P-23/051-S02': '', 'P-23/052-S02': '', 'P-23/053-S02': '', 'P-23/054-S02': '',
        'P-23/055-S02': '', 'P-23/056-S02': '', 'P-23/057-S02': '', 'P-23/058-S02': '', 'P-23/059-S02': '',
        'P-23/060-S02': '', 'P-23/061-S02': '', 'P-23/062-S02': '', 'P-23/063-S02': '', 'P-23/064-S02': '',
        'P-23/065-S02': '', 'P-23/066-S02': '', 'P-23/067-S02': '', 'P-23/068-S02': '', 'P-23/069-S02': '',
        'P-23/070-S02': '', 'P-23/071-S02': '', 'P-23/072-S02': '', 'P-23/073-S02': '', 'P-23/074-S02': '',
        'P-23/075-S02': '', 'P-23/076-S02': '', 'P-23/077-S02': '', 'P-23/078-S02': '', 'P-23/079-S02': '',
        'P-23/080-S02': '', 'P-23/081-S02': '', 'P-23/082-S02': '', 'P-23/083-S02': '', 'P-23/084-S02': '',
        'P-23/085-S02': '', 'P-23/086-S02': '', 'P-23/087-S02': '', 'P-23/088-S02': '', 'P-23/089-S02': '',
        'P-23/090-S02': '', 'P-23/091-S02': '', 'P-23/092-S02': '', 'P-23/093-S02': '', 'P-23/094-S02': '',
        'P-23/095-S02': '', 'P-23/096-S02': '', 'P-23/097-S02': '', 'P-23/098-S02': '', 'P-23/099-S02': '',
        'P-23/100-S02': '', 'P-23/101-S02': '', 'P-23/102-S02': '', 'P-23/103-S02': '', 'P-23/104-S02': '',
        'P-23/105-S02': '', 'P-24/001-S02': '', 'P-24/002-S02': '', 'P-24/003-S02': '', 'P-24/004-S02': '',
        'P-24/005-S02': '', 'P-24/006-S02': '', 'P-24/007-S02': '', 'P-24/008-S02': '', 'P-24/009-S02': '',
        'P-24/010-S02': '', 'P-24/011-S02': '', 'P-24/012-S02': '', 'P-24/013-S02': '', 'P-24/014-S02': '',
        'P-24/015-S02': '', 'P-24/016-S02': '', 'P-24/017-S02': '', 'P-24/018-S02': '', 'P-24/019-S02': '',
        'P-24/020-S02': '', 'P-24/021-S02': '', 'P-24/022-S02': '', 'P-24/023-S02': '', 'P-24/024-S02': '',
        'P-24/025-S02': '', 'P-24/026-S02': '', 'P-24/027-S02': '', 'P-24/028-S02': '', 'P-22/001-S03': '',
        'P-22/002-S03': '', 'P-22/003-S03': '', 'P-22/004-S03': '', 'P-22/005-S03': '', 'P-22/006-S03': '',
        'P-22/007-S03': '', 'P-22/008-S03': '', 'P-22/009-S03': '', 'P-22/010-S03': '', 'P-22/011-S03': '',
        'P-22/012-S03': '', 'P-22/013-S03': '', 'P-22/014-S03': '', 'P-22/015-S03': '', 'P-22/016-S03': '',
        'P-22/017-S03': '', 'P-22/018-S03': '', 'P-22/019-S03': '', 'P-22/020-S03': '', 'P-22/021-S03': '',
        'P-22/022-S03': '', 'P-22/023-S03': '', 'P-22/024-S03': '', 'P-22/025-S03': '', 'P-22/026-S03': '',
        'P-22/027-S03': '', 'P-22/028-S03': '', 'P-22/029-S03': '', 'P-22/030-S03': '', 'P-22/031-S03': '',
        'P-22/032-S03': '', 'P-22/033-S03': '', 'P-22/034-S03': '', 'P-22/035-S03': '', 'P-22/036-S03': '',
        'P-22/037-S03': '', 'P-22/038-S03': '', 'P-22/039-S03': '', 'P-22/040-S03': '', 'P-22/041-S03': '',
        'P-22/042-S03': '', 'P-22/043-S03': '', 'P-22/044-S03': '', 'P-22/045-S03': '', 'P-22/046-S03': '',
        'P-22/047-S03': '', 'P-22/048-S03': '', 'P-22/049-S03': '', 'P-22/050-S03': '', 'P-22/051-S03': '',
        'P-22/052-S03': '', 'P-22/053-S03': '', 'P-22/054-S03': '', 'P-22/055-S03': '', 'P-22/056-S03': '',
        'P-22/057-S03': '', 'P-22/058-S03': '', 'P-22/059-S03': '', 'P-22/060-S03': '', 'P-22/061-S03': '',
        'P-22/062-S03': '', 'P-22/063-S03': '', 'P-22/064-S03': '', 'P-22/065-S03': '', 'P-22/066-S03': '',
        'P-22/067-S03': '', 'P-22/068-S03': '', 'P-22/069-S03': '', 'P-22/070-S03': '', 'P-22/071-S03': '',
        'P-22/072-S03': '', 'P-22/073-S03': '', 'P-22/074-S03': '', 'P-22/075-S03': '', 'P-22/076-S03': '',
        'P-22/077-S03': '', 'P-22/078-S03': '', 'P-22/079-S03': '', 'P-22/080-S03': '', 'P-22/081-S03': '',
        'P-22/082-S03': '', 'P-22/083-S03': '', 'P-22/084-S03': '', 'P-22/085-S03': '', 'P-22/086-S03': '',
        'P-22/087-S03': '', 'P-22/088-S03': '', 'P-22/089-S03': '', 'P-22/090-S03': '', 'P-22/091-S03': '',
        'P-22/092-S03': '', 'P-22/093-S03': '', 'P-22/094-S03': '', 'P-22/095-S03': '', 'P-22/096-S03': '',
        'P-22/097-S03': '', 'P-22/098-S03': '', 'P-22/099-S03': '', 'P-22/100-S03': '', 'P-22/101-S03': '',
        'P-22/102-S03': '', 'P-22/103-S03': '', 'P-22/104-S03': '', 'P-22/105-S03': '', 'P-23/001-S03': '',
        'P-23/002-S03': '', 'P-23/003-S03': '', 'P-23/004-S03': '', 'P-23/005-S03': '', 'P-23/006-S03': '',
        'P-23/007-S03': '', 'P-23/008-S03': '', 'P-23/009-S03': '', 'P-23/010-S03': '', 'P-23/011-S03': '',
        'P-23/012-S03': '', 'P-23/013-S03': '', 'P-23/014-S03': '', 'P-23/015-S03': '', 'P-23/016-S03': '',
        'P-23/017-S03': '', 'P-23/018-S03': '', 'P-23/019-S03': '', 'P-23/020-S03': '', 'P-23/021-S03': '',
        'P-23/022-S03': '', 'P-23/023-S03': '', 'P-23/024-S03': '', 'P-23/025-S03': '', 'P-23/026-S03': '',
        'P-23/027-S03': '', 'P-23/028-S03': '', 'P-23/029-S03': '', 'P-23/030-S03': '', 'P-23/031-S03': '',
        'P-23/032-S03': '', 'P-23/033-S03': '', 'P-23/034-S03': '', 'P-23/035-S03': '', 'P-23/036-S03': '',
        'P-23/037-S03': '', 'P-23/038-S03': '', 'P-23/039-S03': '', 'P-23/040-S03': '', 'P-23/041-S03': '',
        'P-23/042-S03': '', 'P-23/043-S03': '', 'P-23/044-S03': '05-01-2023', 'P-23/045-S03': '', 'P-23/046-S03': '',
        'P-23/047-S03': '', 'P-23/048-S03': '', 'P-23/049-S03': '', 'P-23/050-S03': '', 'P-23/051-S03': '',
        'P-23/052-S03': '', 'P-23/053-S03': '', 'P-23/054-S03': '', 'P-23/055-S03': '', 'P-23/056-S03': '',
        'P-23/057-S03': '', 'P-23/058-S03': '', 'P-23/059-S03': '', 'P-23/060-S03': '', 'P-23/061-S03': '',
        'P-23/062-S03': '', 'P-23/063-S03': '', 'P-23/064-S03': '', 'P-23/065-S03': '', 'P-23/066-S03': '',
        'P-23/067-S03': '', 'P-23/068-S03': '', 'P-23/069-S03': '', 'P-23/070-S03': '', 'P-23/071-S03': '',
        'P-23/072-S03': '', 'P-23/073-S03': '', 'P-23/074-S03': '', 'P-23/075-S03': '', 'P-23/076-S03': '',
        'P-23/077-S03': '', 'P-23/078-S03': '', 'P-23/079-S03': '', 'P-23/080-S03': '', 'P-23/081-S03': '',
        'P-23/082-S03': '', 'P-23/083-S03': '', 'P-23/084-S03': '', 'P-23/085-S03': '', 'P-23/086-S03': '',
        'P-23/087-S03': '', 'P-23/088-S03': '', 'P-23/089-S03': '', 'P-23/090-S03': '', 'P-23/091-S03': '',
        'P-23/092-S03': '', 'P-23/093-S03': '', 'P-23/094-S03': '', 'P-23/095-S03': '', 'P-23/096-S03': '',
        'P-23/097-S03': '', 'P-23/098-S03': '', 'P-23/099-S03': '', 'P-23/100-S03': '', 'P-23/101-S03': '',
        'P-23/102-S03': '', 'P-23/103-S03': '', 'P-23/104-S03': '', 'P-23/105-S03': '', 'P-24/001-S03': '',
        'P-24/002-S03': '', 'P-24/003-S03': '', 'P-24/004-S03': '', 'P-24/005-S03': '', 'P-24/006-S03': '',
        'P-24/007-S03': '', 'P-24/008-S03': '', 'P-24/009-S03': '', 'P-24/010-S03': '', 'P-24/011-S03': '',
        'P-24/012-S03': '', 'P-24/013-S03': '', 'P-24/014-S03': '', 'P-24/015-S03': '', 'P-24/016-S03': '',
        'P-24/017-S03': '', 'P-24/018-S03': '', 'P-24/019-S03': '', 'P-24/020-S03': '', 'P-24/021-S03': '',
        'P-24/022-S03': '', 'P-24/023-S03': '', 'P-24/024-S03': '', 'P-24/025-S03': '', 'P-24/026-S03': '',
        'P-24/027-S03': '', 'P-24/028-S03': '', 'P-22/001-S04': '', 'P-22/002-S04': '', 'P-22/003-S04': '',
        'P-22/004-S04': '', 'P-22/005-S04': '', 'P-22/006-S04': '', 'P-22/007-S04': '', 'P-22/008-S04': '',
        'P-22/009-S04': '', 'P-22/010-S04': '', 'P-22/011-S04': '', 'P-22/012-S04': '', 'P-22/013-S04': '',
        'P-22/014-S04': '', 'P-22/015-S04': '', 'P-22/016-S04': '', 'P-22/017-S04': '', 'P-22/018-S04': '',
        'P-22/019-S04': '', 'P-22/020-S04': '', 'P-22/021-S04': '', 'P-22/022-S04': '', 'P-22/023-S04': '',
        'P-22/024-S04': '', 'P-22/025-S04': '', 'P-22/026-S04': '', 'P-22/027-S04': '', 'P-22/028-S04': '',
        'P-22/029-S04': '', 'P-22/030-S04': '', 'P-22/031-S04': '', 'P-22/032-S04': '', 'P-22/033-S04': '',
        'P-22/034-S04': '', 'P-22/035-S04': '', 'P-22/036-S04': '', 'P-22/037-S04': '', 'P-22/038-S04': '',
        'P-22/039-S04': '', 'P-22/040-S04': '', 'P-22/041-S04': '', 'P-22/042-S04': '', 'P-22/043-S04': '',
        'P-22/044-S04': '', 'P-22/045-S04': '', 'P-22/046-S04': '', 'P-22/047-S04': '', 'P-22/048-S04': '',
        'P-22/049-S04': '', 'P-22/050-S04': '', 'P-22/051-S04': '', 'P-22/052-S04': '', 'P-22/053-S04': '',
        'P-22/054-S04': '', 'P-22/055-S04': '', 'P-22/056-S04': '', 'P-22/057-S04': '', 'P-22/058-S04': '',
        'P-22/059-S04': '', 'P-22/060-S04': '', 'P-22/061-S04': '', 'P-22/062-S04': '', 'P-22/063-S04': '',
        'P-22/064-S04': '', 'P-22/065-S04': '', 'P-22/066-S04': '', 'P-22/067-S04': '', 'P-22/068-S04': '',
        'P-22/069-S04': '', 'P-22/070-S04': '', 'P-22/071-S04': '', 'P-22/072-S04': '', 'P-22/073-S04': '',
        'P-22/074-S04': '', 'P-22/075-S04': '', 'P-22/076-S04': '', 'P-22/077-S04': '', 'P-22/078-S04': '',
        'P-22/079-S04': '', 'P-22/080-S04': '', 'P-22/081-S04': '', 'P-22/082-S04': '', 'P-22/083-S04': '',
        'P-22/084-S04': '', 'P-22/085-S04': '', 'P-22/086-S04': '', 'P-22/087-S04': '', 'P-22/088-S04': '',
        'P-22/089-S04': '', 'P-22/090-S04': '', 'P-22/091-S04': '', 'P-22/092-S04': '', 'P-22/093-S04': '',
        'P-22/094-S04': '', 'P-22/095-S04': '', 'P-22/096-S04': '', 'P-22/097-S04': '', 'P-22/098-S04': '',
        'P-22/099-S04': '', 'P-22/100-S04': '', 'P-22/101-S04': '', 'P-22/102-S04': '', 'P-22/103-S04': '',
        'P-22/104-S04': '', 'P-22/105-S04': '', 'P-23/001-S04': '', 'P-23/002-S04': '', 'P-23/003-S04': '',
        'P-23/004-S04': '', 'P-23/005-S04': '', 'P-23/006-S04': '', 'P-23/007-S04': '', 'P-23/008-S04': '',
        'P-23/009-S04': '', 'P-23/010-S04': '', 'P-23/011-S04': '', 'P-23/012-S04': '', 'P-23/013-S04': '',
        'P-23/014-S04': '', 'P-23/015-S04': '', 'P-23/016-S04': '', 'P-23/017-S04': '', 'P-23/018-S04': '',
        'P-23/019-S04': '', 'P-23/020-S04': '', 'P-23/021-S04': '', 'P-23/022-S04': '', 'P-23/023-S04': '',
        'P-23/024-S04': '', 'P-23/025-S04': '', 'P-23/026-S04': '', 'P-23/027-S04': '', 'P-23/028-S04': '',
        'P-23/029-S04': '', 'P-23/030-S04': '', 'P-23/031-S04': '', 'P-23/032-S04': '', 'P-23/033-S04': '',
        'P-23/034-S04': '', 'P-23/035-S04': '', 'P-23/036-S04': '', 'P-23/037-S04': '', 'P-23/038-S04': '',
        'P-23/039-S04': '', 'P-23/040-S04': '', 'P-23/041-S04': '', 'P-23/042-S04': '', 'P-23/043-S04': '',
        'P-23/044-S04': '29-04-2024', 'P-23/045-S04': '', 'P-23/046-S04': '', 'P-23/047-S04': '', 'P-23/048-S04': '',
        'P-23/049-S04': '', 'P-23/050-S04': '', 'P-23/051-S04': '', 'P-23/052-S04': '', 'P-23/053-S04': '',
        'P-23/054-S04': '', 'P-23/055-S04': '', 'P-23/056-S04': '', 'P-23/057-S04': '', 'P-23/058-S04': '',
        'P-23/059-S04': '', 'P-23/060-S04': '', 'P-23/061-S04': '', 'P-23/062-S04': '', 'P-23/063-S04': '',
        'P-23/064-S04': '', 'P-23/065-S04': '', 'P-23/066-S04': '', 'P-23/067-S04': '', 'P-23/068-S04': '',
        'P-23/069-S04': '', 'P-23/070-S04': '', 'P-23/071-S04': '', 'P-23/072-S04': '', 'P-23/073-S04': '',
        'P-23/074-S04': '', 'P-23/075-S04': '', 'P-23/076-S04': '', 'P-23/077-S04': '', 'P-23/078-S04': '',
        'P-23/079-S04': '', 'P-23/080-S04': '', 'P-23/081-S04': '', 'P-23/082-S04': '', 'P-23/083-S04': '',
        'P-23/084-S04': '', 'P-23/085-S04': '', 'P-23/086-S04': '', 'P-23/087-S04': '', 'P-23/088-S04': '',
        'P-23/089-S04': '', 'P-23/090-S04': '', 'P-23/091-S04': '', 'P-23/092-S04': '', 'P-23/093-S04': '',
        'P-23/094-S04': '', 'P-23/095-S04': '', 'P-23/096-S04': '', 'P-23/097-S04': '', 'P-23/098-S04': '',
        'P-23/099-S04': '', 'P-23/100-S04': '', 'P-23/101-S04': '', 'P-23/102-S04': '', 'P-23/103-S04': '',
        'P-23/104-S04': '', 'P-23/105-S04': '', 'P-24/001-S04': '', 'P-24/002-S04': '', 'P-24/003-S04': '',
        'P-24/004-S04': '', 'P-24/005-S04': '', 'P-24/006-S04': '', 'P-24/007-S04': '', 'P-24/008-S04': '',
        'P-24/009-S04': '', 'P-24/010-S04': '', 'P-24/011-S04': '', 'P-24/012-S04': '', 'P-24/013-S04': '',
        'P-24/014-S04': '', 'P-24/015-S04': '', 'P-24/016-S04': '', 'P-24/017-S04': '', 'P-24/018-S04': '',
        'P-24/019-S04': '', 'P-24/020-S04': '', 'P-24/021-S04': '', 'P-24/022-S04': '', 'P-24/023-S04': '',
        'P-24/024-S04': '', 'P-24/025-S04': '', 'P-24/026-S04': '', 'P-24/027-S04': '', 'P-24/028-S04': ''
    }

    df['Fecha AP VDDL'] = df['Fecha AP VDDL'].map(mapping).fillna(np.nan)

    return df

def identificar_cliente_por_PO(df):
    """
    Funci√≥n para identificar el cliente a trav√©s del n√∫mero de pedido (PO) utilizando expresiones regulares.

    Args:
        df (pandas.DataFrame): DataFrame que contiene la columna 'PO'.

    Returns:
        pandas.DataFrame: DataFrame actualizado con la columna 'Cliente' identificada.
    """
    # mapping (dict): Diccionario de mapeo para identificar el cliente seg√∫n el n√∫mero de pedido.
    mapping = {'10121': 'DUQM', '10150': 'BAPCO',
               '10160': 'CRISP', '10230': 'MARJAN',
               '10318': 'RAS TANURA', '10330': 'NEW PTA COMPLEX',
               '10370': 'QATAR EPC3', '10380': 'YPF',
               '10400': 'ADNOC', '10430': 'QATAR EPC4',
               '23222': 'CQP', '23262': 'Certificado',
               '33138': 'DUQM', '70150': 'SEWA',
               '70215': 'CFE MERIDA', '70225': 'C.C. VALLADOLID',
               '70230': 'C.C. GONZALEZ ORTEGA', '70240': 'C.C. SAN LUIS',
               '80057': 'BU HASA', '80091': 'T.R. ENAP',
               '19085': 'T.R. CEPSA', '30011': 'TECHNIP',
               '75001': 'TECNIMONT', '60001': 'CEPSA',
               '70112': 'CEPSA', '70801': 'CEPSA',
               '15282': 'ASTCOR', '20623': 'REPSOL PETR√ìLEO',
               'T22B16': 'CNTCC', '56275': 'ALMARAZ'}

    # Definir la expresi√≥n regular para extraer los primeros 5 d√≠gitos del n√∫mero de pedido (PO)
    regex_pattern = r'((?:T\d+B\d+)|\d{5})'

    # Aplicar la expresi√≥n regular para extraer los primeros 5 d√≠gitos del PO y mapear el cliente
    df['Cliente'] = df['N¬∫ PO'].apply(lambda x: mapping[re.match(regex_pattern, x).group(1)] if re.match(regex_pattern, x) else '')

    return df

# Funci√≥n aplicable para el tratamiento y coloreado de datos en la tabla de excel
def highlight_row_content(column, value, color):
    cont_val = column == value
    return [f'background-color: {color}' if cont_val.any() else '' for v in cont_val]

# Funci√≥n para definir el rango de las celdas
def auto_fit_columns(sheet):
    if sheet:
        for col_index in range(sheet.getCells().getMaxDataColumn() + 1):
            sheet.autoFitColumn(col_index)

# Coloreado y estilos de la tabla de excel
def apply_excel_styles(today_date):
    # Carga el archivo de Excel existente
    archivo_excel = "Monitoring_Report_" + str(today_date) + ".xlsx"
    workbook = load_workbook(archivo_excel)

    # Definir los estilos
    fecha_style = NamedStyle(name='fecha')
    fecha_style.number_format = 'DD-MM-YYYY'
    cell_filling_blue_light = PatternFill(start_color="D4DCF4", end_color="D4DCF4", fill_type="solid")
    cell_filling = PatternFill(start_color="6678AF", end_color="6678AF", fill_type="solid")
    medium_dashed = Border(left=Side(style='thin'),
                           right=Side(style='thin'),
                           top=Side(style='thin'),
                           bottom=Side(style='thin'))
    font_white = Font(color='FFFFFF', bold=True)
    font_black = Font(color='000000')

    # Funci√≥n para aplicar estilos a una hoja
    def apply_styles_to_sheet(sheet, tab_color, max_row, max_col, column_exceptions=('J',)):
        freeze = sheet['B2']
        sheet.freeze_panes = freeze
        sheet.sheet_properties.tabColor = tab_color

        for row_idx, row in enumerate(sheet.iter_rows(), start=1):
            if row_idx == 1:
                for cell in row:
                    if cell.column_letter not in column_exceptions:
                        cell.style = fecha_style
                        cell.fill = cell_filling
            else:
                for cell in row:
                    if cell.column_letter not in column_exceptions:
                        if isinstance(cell.value, datetime):
                            cell.style = fecha_style
                        cell.fill = cell_filling_blue_light

        for row in sheet.iter_rows():
            for cell in row:
                cell.border = medium_dashed

        cell_letters = sheet['J1']
        cell_letters.fill = cell_filling
        cell_letters = sheet['K1']
        cell_letters.fill = cell_filling

        for cell in sheet[1]:
            cell.font = font_white

        for row_idx, row in enumerate(sheet.iter_rows(), start=1):
            if row_idx != 1:
                for cell in row:
                    cell.font = font_black

        for fila in sheet.iter_rows(min_row=1, max_row=max_row, min_col=9, max_col=9):
            for celda in fila:
                if celda.value == 'S√≠':
                    celda.font = Font(color='FF5B5B', bold=True)

        sheet.auto_filter.ref = f"A1:{chr(65+max_col-1)}{max_row}"

    # Aplicar estilos a cada hoja
    apply_styles_to_sheet(workbook['Documentaci√≥n con comentarios'], "DBB054", 200, 21, ('J', 'K'))
    apply_styles_to_sheet(workbook['Enviada para aprobaci√≥n'], "B1E1B9", 200, 20, ('J'))
    apply_styles_to_sheet(workbook['Documentaci√≥n sin enviar'], "DDDDDD", 200, 13, ('J'))
    apply_styles_to_sheet(workbook['CR√çTICOS'], "FFFFAB", 200, 13, ('J'))

    # Guardar el archivo modificado
    workbook.save(archivo_excel)
    print("¬°Creando los filtros de las columnas!")